<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="NMA">
<title>Running an NMA with a Reference file and test data â€¢ NMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Running an NMA with a Reference file and test data">
<meta property="og:description" content="NMA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/how-to-use-nma-test-data.html">Using survival data</a>
    <a class="dropdown-item" href="../articles/reference-file-test-data.html">Reference file</a>
    <a class="dropdown-item" href="../articles/count-data.html">Using binary data</a>
    <a class="dropdown-item" href="../articles/binary-data.html">Using count data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ICON-in-R/NMA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Running an NMA with a Reference file and test data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ICON-in-R/NMA/blob/HEAD/vignettes/reference-file-test-data.Rmd" class="external-link"><code>vignettes/reference-file-test-data.Rmd</code></a></small>
      <div class="d-none name"><code>reference-file-test-data.Rmd</code></div>
    </div>

    
    
<p>Borrowing from the approach in the <code>heemod</code> package, as
well as defining the analysis in an <code>R</code> script it is also
possible to specify the analysis with only file inputs. This vignette
will show how to do this with a simple example.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The idea is to create folder with all of the information needed to
run the NMA analysis contained in files within. The meta information
about the contents of the folder is contained in a <em>reference
file</em>. The reference file is called <code>REFERENCE.csv</code>.</p>
</div>
<div class="section level2">
<h2 id="reference-file">Reference file<a class="anchor" aria-label="anchor" href="#reference-file"></a>
</h2>
<p>This file contains two columns called <code>type</code> and
<code>file</code>. Rows in the <code>type</code> column must contain one
of the following keywords:</p>
<ul>
<li>
<code>bugs</code>: File containing the BUGS input parameters for
MCMC</li>
<li>
<code>analysis</code>: File containing the scenario information</li>
<li>
<code>subData</code>: Mandatory NMA data. Required column headings
of <code>tx</code>, <code>base</code>, <code>study</code>,
<code>Lmean</code>, <code>Lse</code>, <code>multi_arm</code>
</li>
<li>
<code>subDataBin</code>: Optional binary data. Required column
headings of <code>tx</code>, <code>base</code>, <code>study</code>,
<code>BinN</code>, <code>BinR</code>
</li>
<li>
<code>subDataMed</code>: Optional median time data. Required column
headings of <code>tx</code>, <code>base</code>, <code>study</code>,
<code>medN</code>, <code>medR</code>, <code>median</code>
</li>
</ul>
<table class="table">
<thead><tr class="header">
<th><code>type</code></th>
<th><code>file</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>bugs</code></td>
<td><code>bugs.csv</code></td>
</tr>
<tr class="even">
<td><code>analysis</code></td>
<td><code>analysis.csv</code></td>
</tr>
<tr class="odd">
<td><code>subData</code></td>
<td><code>subData.csv</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="parameter-files">Parameter files<a class="anchor" aria-label="anchor" href="#parameter-files"></a>
</h2>
<p><code>bugs.csv</code> includes: OpenBUGS or WinBUGS option
<code>PROG</code>, <code>N.BURNIN</code>, <code>N.SIMS</code>,
<code>N.CHAINS</code>, <code>N.THIN</code>, <code>PAUSE.</code> For
example,</p>
<pre><code>PROG, openBugs
N.BURNIN, 1000
N.SIMS, 1500
N.CHAINS, 2
N.THIN, 1
PAUSE, TRUE</code></pre>
<p>and <code>analysis.csv</code> includes: whether a random effects
model, <code>is_random</code>; the type of survival data,
<code>data_type</code>the reference treatment, <code>REFTX</code>;
<code>effectParam</code>, <code>label</code> and <code>endpoint</code>.
For example,</p>
<pre><code>is_random, FALSE
data_type, hr_data
refTx, X
effectParam, beta
label, my_label
endpoint, my_endpoint</code></pre>
</div>
<div class="section level2">
<h2 id="running-an-nma">Running an NMA<a class="anchor" aria-label="anchor" href="#running-an-nma"></a>
</h2>
<p>A single call sets-up the NMA represented by the contents of the
folder.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nma_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_NMA_dir.html">new_NMA_dir</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst/analysis_folder_test"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="run-mcmc">Run MCMC<a class="anchor" aria-label="anchor" href="#run-mcmc"></a>
</h3>
<p>The NMA MCMC function calls the appropriate BUGS model in the usual
way.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nma_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMA_run.html">NMA_run</a></span><span class="op">(</span><span class="va">nma_model</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; ====== RUNNING BUGS MODEL</span>

<span class="va">nma_res</span>
<span class="co">#&gt; Inference for Bugs model at "C:\Users\n8tha\AppData\Local\Temp\Rtmp0UB0w3/bugs_model.txt", </span>
<span class="co">#&gt;  2 chains, each with 2500 iterations (first 1000 discarded)</span>
<span class="co">#&gt;  n.sims = 3000 iterations saved</span>
<span class="co">#&gt;          mean  sd 2.5%  25%  50%  75% 97.5% Rhat n.eff</span>
<span class="co">#&gt; beta[2]  -0.2 0.1 -0.4 -0.2 -0.2 -0.1   0.1    1  1200</span>
<span class="co">#&gt; beta[3]  -0.4 0.1 -0.7 -0.5 -0.4 -0.3  -0.2    1  2300</span>
<span class="co">#&gt; totLdev  37.0 2.1 35.0 35.6 36.4 37.8  42.7    1  3000</span>
<span class="co">#&gt; deviance 31.0 2.1 29.1 29.6 30.4 31.8  36.8    1  3000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; DIC info (using the rule, pD = Dbar-Dhat)</span>
<span class="co">#&gt; pD = 2.0 and DIC = 33.1</span>
<span class="co">#&gt; DIC is an estimate of expected predictive error (lower deviance is better).</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nathan Green.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
