<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="NMA">
<title>How to use NMA: Introduction with test data • NMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use NMA: Introduction with test data">
<meta property="og:description" content="NMA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/how-to-use-nma-test-data.html">Introduction</a>
    <a class="dropdown-item" href="../articles/reference-file-test-data.html">Reference file</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ICON-in-R/NMA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to use NMA: Introduction with test data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ICON-in-R/NMA/blob/HEAD/vignettes/how-to-use-nma-test-data.Rmd" class="external-link"><code>vignettes/how-to-use-nma-test-data.Rmd</code></a></small>
      <div class="d-none name"><code>how-to-use-nma-test-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document describes how to use the main functions of
<code>NMA</code> to run a single network meta-analysis.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>First load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icon-in-r.github.io/NMA">NMA</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="settings">Settings<a class="anchor" aria-label="anchor" href="#settings"></a>
</h3>
<p>Define the BUGS parameters for MCMC. This is not necessary, but
recommended, because there are default values for these.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bugs_params</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    PROG <span class="op">=</span> <span class="st">"openBugs"</span>,  <span class="co"># which version of BUGS to use to run the MCMC</span>
    N.BURNIN <span class="op">=</span> <span class="fl">10</span>,<span class="co">#00,  # number of steps to throw away</span>
    N.SIMS <span class="op">=</span> <span class="fl">150</span>,<span class="co">#0,    # total number of simulations</span>
    N.CHAINS <span class="op">=</span> <span class="fl">2</span>,       <span class="co"># number of chains</span>
    N.THIN <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># thinning rate</span>
    PAUSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Define the scenario we will use for the analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RANDOM</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>             <span class="co"># is this a random effects model?</span>
<span class="va">REFTX</span> <span class="op">&lt;-</span> <span class="st">"X"</span>                <span class="co"># reference treatment</span>
<span class="va">is_bin</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>              <span class="co"># include binary data?</span>
<span class="va">is_med</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>              <span class="co"># include median data?</span>
<span class="va">label_name</span> <span class="op">&lt;-</span> <span class="st">"label_name"</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="read-in-datasets">Read in datasets<a class="anchor" aria-label="anchor" href="#read-in-datasets"></a>
</h3>
<p>The trials data consist of up to 3 separate data frames. A main
table, <code>subData</code>, and optional tables for median event time
and binary data, <code>subDataMed</code> and <code>subDataBin</code>
respectively. Lets read in the each data set separately. In another
article we will show how to do this in one function call by including a
<em>Reference</em> file in the data folder which contains the meta data
of how to read in the study data. If there is no binary or median data
used in the NMA then the variables <code>subDataBin</code> and
<code>subDataMed</code> are assigned <code>NA</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"raw_data"</span>, <span class="st">"survdata_"</span><span class="op">)</span><span class="op">)</span>

<span class="va">subData</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="st">"main_test.csv"</span><span class="op">)</span>,
           header <span class="op">=</span> <span class="cn">TRUE</span>,
           as.is <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">subDataBin</span> <span class="op">&lt;-</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">is_bin</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="st">"bin_test.csv"</span><span class="op">)</span>,
             header <span class="op">=</span> <span class="cn">TRUE</span>,
             as.is <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="cn">NA</span><span class="op">}</span>

<span class="va">subDataMed</span> <span class="op">&lt;-</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">is_med</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="st">"med_test.csv"</span><span class="op">)</span>,
             header <span class="op">=</span> <span class="cn">TRUE</span>,
             as.is <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>medR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">medR</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="cn">NA</span><span class="op">}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-model">Build model<a class="anchor" aria-label="anchor" href="#build-model"></a>
</h3>
<p>Now we can create the NMA object to use in the modelling. The
workflow is to first create this separately to actually doing the
fitting. This then means that we can perform modified fits but we don’t
have to redo any of the preparatory work.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nma_model</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/new_NMA.html">new_NMA</a></span><span class="op">(</span>subData <span class="op">=</span> <span class="va">subData</span>,
          subDataMed <span class="op">=</span> <span class="va">subDataMed</span>,
          subDataBin <span class="op">=</span> <span class="va">subDataBin</span>,
          bugs_params <span class="op">=</span> <span class="va">bugs_params</span>,
          is_random <span class="op">=</span> <span class="va">RANDOM</span>,
          refTx <span class="op">=</span> <span class="va">REFTX</span> ,
          effectParam <span class="op">=</span> <span class="st">"beta"</span>,
          modelParams <span class="op">=</span> <span class="st">"totresdev"</span>,
          label <span class="op">=</span> <span class="st">""</span>,
          endpoint <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="va">nma_model</span>
<span class="co">#&gt; $dat</span>
<span class="co">#&gt; $dat$inits</span>
<span class="co">#&gt; function() {</span>
<span class="co">#&gt;       list(</span>
<span class="co">#&gt;         beta = c(NA, rnorm(nTx - 1, 0, 2)),</span>
<span class="co">#&gt;         sd = 0.1,</span>
<span class="co">#&gt;         alpha = rnorm(nStudies)) %&gt;% </span>
<span class="co">#&gt;         .[param_names]</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt; &lt;bytecode: 0x0000000013ac5430&gt;</span>
<span class="co">#&gt; &lt;environment: 0x00000000138f9cc0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$subData</span>
<span class="co">#&gt;   study base tx      Lmean       Lse multi_arm Ltx Lbase Lstudy</span>
<span class="co">#&gt; 1     A    X  Y -0.5259393 0.1275307         0   2     1      1</span>
<span class="co">#&gt; 2     B    Y  Z -0.7133499 0.1437422         0   3     2      2</span>
<span class="co">#&gt; 3     C    Z  X -0.3011051 0.1758496         0   1     3      3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$subDataBin</span>
<span class="co">#&gt;   study base tx BinR BinN Btx Bbase Bstudy</span>
<span class="co">#&gt; 1     A    X  X   34   38   1     1      1</span>
<span class="co">#&gt; 2     B    X  Y   27   33   2     1      2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$subDataMed</span>
<span class="co">#&gt;   study base tx median medN medR mediantx medianbase medianstudy</span>
<span class="co">#&gt; 1     A    X  Y   14.0   45   22        2          1           1</span>
<span class="co">#&gt; 2     B    Y  Z   18.0   45   22        3          2           2</span>
<span class="co">#&gt; 3     C    Z  X   15.1   10    5        1          3           3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData</span>
<span class="co">#&gt; $dat$bugsData$mu_beta</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$prec_beta</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$mu_alpha</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$prec_alpha</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Lstudy</span>
<span class="co">#&gt; [1] 1 2 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Ltx</span>
<span class="co">#&gt; [1] 2 3 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Lbase</span>
<span class="co">#&gt; [1] 1 2 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Lmean</span>
<span class="co">#&gt; [1] -0.5259393 -0.7133499 -0.3011051</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Lse</span>
<span class="co">#&gt; [1] 0.1275307 0.1437422 0.1758496</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$multi</span>
<span class="co">#&gt; [1] 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$LnObs</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$nTx</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$nStudies</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianStudy</span>
<span class="co">#&gt; [1] 1 2 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianTx</span>
<span class="co">#&gt; [1] 2 3 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianBase</span>
<span class="co">#&gt; [1] 1 2 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Bstudy</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Btx</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Bbase</span>
<span class="co">#&gt; [1] 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianN</span>
<span class="co">#&gt; [1] 45 45 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianR</span>
<span class="co">#&gt; [1] 22 22  5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$median</span>
<span class="co">#&gt; [1] 14.0 18.0 15.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$medianNObs</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Bn</span>
<span class="co">#&gt; [1] 38 33</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$Br</span>
<span class="co">#&gt; [1] 34 27</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$bugsData$BnObs</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dat$txList</span>
<span class="co">#&gt; [1] "X" "Y" "Z"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_med</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_bin</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params</span>
<span class="co">#&gt; $bugs_params$PROG</span>
<span class="co">#&gt; [1] "openBugs"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$N.BURNIN</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$N.SIMS</span>
<span class="co">#&gt; [1] 150</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$N.CHAINS</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$N.THIN</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$PAUSE</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_params$run_bugs</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bugs_fn</span>
<span class="co">#&gt; function(...)</span>
<span class="co">#&gt;         R2OpenBUGS::bugs(...)</span>
<span class="co">#&gt; &lt;bytecode: 0x000000001fb74f28&gt;</span>
<span class="co">#&gt; &lt;environment: 0x000000001fb78f98&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_random</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $refTx</span>
<span class="co">#&gt; [1] "X"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $effectParam</span>
<span class="co">#&gt; [1] "beta"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $modelParams</span>
<span class="co">#&gt; [1] "totresdev"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $label</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $endpoint</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "nma"</span>
<span class="co">#&gt; attr(,"CALL")</span>
<span class="co">#&gt; attr(,"CALL")$subData</span>
<span class="co">#&gt; subData</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$subDataMed</span>
<span class="co">#&gt; subDataMed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$subDataBin</span>
<span class="co">#&gt; subDataBin</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$bugs_params</span>
<span class="co">#&gt; bugs_params</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$is_random</span>
<span class="co">#&gt; RANDOM</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$refTx</span>
<span class="co">#&gt; REFTX</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$effectParam</span>
<span class="co">#&gt; [1] "beta"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$modelParams</span>
<span class="co">#&gt; [1] "totresdev"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$label</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"CALL")$endpoint</span>
<span class="co">#&gt; [1] ""</span></code></pre></div>
<p>We can view the network graph.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org" class="external-link">sna</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/plotNetwork.html">plotNetwork</a></span><span class="op">(</span><span class="va">nma_model</span><span class="op">)</span></code></pre></div>
<p><img src="how-to-use-nma-test-data_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="run-mcmc">Run MCMC<a class="anchor" aria-label="anchor" href="#run-mcmc"></a>
</h3>
<p>The NMA MCMC function calls the appropriate BUGS model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nma_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMA_run.html">NMA_run</a></span><span class="op">(</span><span class="va">nma_model</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; ====== RUNNING BUGS MODEL</span>

<span class="va">nma_res</span>
<span class="co">#&gt; Inference for Bugs model at "C:/Users/Nathan/Documents/R/NMA/inst/FE_med_bin.txt", </span>
<span class="co">#&gt;  2 chains, each with 160 iterations (first 10 discarded)</span>
<span class="co">#&gt;  n.sims = 300 iterations saved</span>
<span class="co">#&gt;            mean    sd  2.5%   25%   50%   75% 97.5% Rhat n.eff</span>
<span class="co">#&gt; beta[2]    -0.1   0.7  -1.0  -0.8  -0.2   0.7   0.9  3.4     3</span>
<span class="co">#&gt; beta[3]    -1.0   0.4  -1.8  -1.3  -0.9  -0.8  -0.6  1.5     6</span>
<span class="co">#&gt; totresdev 270.0 155.6  76.7 119.0 250.2 412.1 540.9  1.6     5</span>
<span class="co">#&gt; deviance  421.7 116.3 292.2 312.5 407.6 533.1 633.8  1.7     5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; DIC info (using the rule, pD = Dbar-Dhat)</span>
<span class="co">#&gt; pD = 90.5 and DIC = 512.2</span>
<span class="co">#&gt; DIC is an estimate of expected predictive error (lower deviance is better).</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reconfigure-model">Reconfigure model<a class="anchor" aria-label="anchor" href="#reconfigure-model"></a>
</h3>
<p>It is simple to modify an existing analysis without repeating the
previous steps. For example, we can run the NMA for a random effects
rather than a fixed effects model version of the same model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nma_model2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/NMA_update.html">NMA_update</a></span><span class="op">(</span><span class="va">nma_model</span>,
             is_random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">nma_res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMA_run.html">NMA_run</a></span><span class="op">(</span><span class="va">nma_model2</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; ====== RUNNING BUGS MODEL</span>

<span class="va">nma_res2</span>
<span class="co">#&gt; Inference for Bugs model at "C:/Users/Nathan/Documents/R/NMA/inst/RE_med_bin.txt", </span>
<span class="co">#&gt;  2 chains, each with 160 iterations (first 10 discarded)</span>
<span class="co">#&gt;  n.sims = 300 iterations saved</span>
<span class="co">#&gt;            mean    sd  2.5%   25%   50%   75% 97.5% Rhat n.eff</span>
<span class="co">#&gt; beta[2]    -0.9   0.6  -1.9  -1.5  -1.1  -0.2   0.0  3.8     2</span>
<span class="co">#&gt; beta[3]     0.4   2.0  -2.5  -1.3  -0.5   2.5   3.4  4.9     2</span>
<span class="co">#&gt; totresdev 190.3 127.1  56.3  81.6 198.2 257.8 438.0  3.2     3</span>
<span class="co">#&gt; deviance  227.9 117.9 118.4 132.7 231.3 282.1 470.8  2.7     3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; DIC info (using the rule, pD = Dbar-Dhat)</span>
<span class="co">#&gt; pD = 44.4 and DIC = 272.3</span>
<span class="co">#&gt; DIC is an estimate of expected predictive error (lower deviance is better).</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-and-tables">Plot and tables<a class="anchor" aria-label="anchor" href="#plot-and-tables"></a>
</h3>
<p>BUGS plots are available for diagnosing the performance.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">diagnostics</span><span class="op">(</span><span class="va">nma_res2</span>, save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Different NMA tables can be created. They can provide a record of the
analysis.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/write_data_to_file.html">write_data_to_file</a></span><span class="op">(</span><span class="va">nma_model</span><span class="op">)</span>
<span class="fu"><a href="../reference/write_results_table.html">write_results_table</a></span><span class="op">(</span><span class="va">nma_model</span>, <span class="va">nma_res</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pairwiseTable.html">pairwiseTable</a></span><span class="op">(</span><span class="va">nma_model</span>, <span class="va">nma_res</span><span class="op">)</span>
<span class="co">#&gt;   X                  Y                  Z                 </span>
<span class="co">#&gt; X "1 (1,1)"          "1.17 (0.39,2.83)" "2.39 (1.75,6.15)"</span>
<span class="co">#&gt; Y "0.86 (0.35,2.57)" "1 (1,1)"          "2.24 (1.28,5.44)"</span>
<span class="co">#&gt; Z "0.42 (0.16,0.57)" "0.45 (0.18,0.78)" "1 (1,1)"</span></code></pre></div>
<p>Currently available NMA plots are a treatment effect forest plot of
posterior samples and a rank probability grid.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/txEffectPlot.html">txEffectPlot</a></span><span class="op">(</span><span class="va">nma_model</span>, <span class="va">nma_res</span><span class="op">)</span></code></pre></div>
<p><img src="how-to-use-nma-test-data_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rankProbPlot.html">rankProbPlot</a></span><span class="op">(</span><span class="va">nma_model</span>, <span class="va">nma_res</span><span class="op">)</span></code></pre></div>
<p><img src="how-to-use-nma-test-data_files/figure-html/unnamed-chunk-12-2.png" width="768"></p>
<p>It’s also possible to create all of the BUGS and output plots and
table functions together and write to an analysis folder.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/nma_outputs.html">nma_outputs</a></span><span class="op">(</span><span class="va">nma_res2</span>, save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nathan Green.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
